{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "respective-majority",
   "metadata": {},
   "source": [
    "## Ordering Discrete Values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "protected-butter",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "   <div id=\"lOKMBO\"></div>\n",
       "   <script type=\"text/javascript\" data-lets-plot-script=\"library\">\n",
       "       if(!window.letsPlotCallQueue) {\n",
       "           window.letsPlotCallQueue = [];\n",
       "       }; \n",
       "       window.letsPlotCall = function(f) {\n",
       "           window.letsPlotCallQueue.push(f);\n",
       "       };\n",
       "       (function() {\n",
       "           var script = document.createElement(\"script\");\n",
       "           script.type = \"text/javascript\";\n",
       "           script.src = \"https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v2.4.0/js-package/distr/lets-plot.min.js\";\n",
       "           script.onload = function() {\n",
       "               window.letsPlotCall = function(f) {f();};\n",
       "               window.letsPlotCallQueue.forEach(function(f) {f();});\n",
       "               window.letsPlotCallQueue = [];\n",
       "               \n",
       "               \n",
       "           };\n",
       "           script.onerror = function(event) {\n",
       "               window.letsPlotCall = function(f) {};\n",
       "               window.letsPlotCallQueue = [];\n",
       "               var div = document.createElement(\"div\");\n",
       "               div.style.color = 'darkred';\n",
       "               div.textContent = 'Error loading Lets-Plot JS';\n",
       "               document.getElementById(\"lOKMBO\").appendChild(div);\n",
       "           };\n",
       "           var e = document.getElementById(\"lOKMBO\");\n",
       "           e.appendChild(script);\n",
       "       })();\n",
       "   </script>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%useLatestDescriptors\n",
    "%use lets-plot\n",
    "// %use krangl"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "selected-covering",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Lets-Plot Kotlin API v.4.0.0. Frontend: Notebook with dynamically loaded JS. Lets-Plot JS v.2.4.0."
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "LetsPlot.getInfo()  // This prevents Krangl from loading an obsolete version of Lets-Plot classes."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "concrete-library",
   "metadata": {},
   "outputs": [],
   "source": [
    "%use krangl"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "emotional-stage",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<html><body><table><tr><th style=\"text-align:left\"></th><th style=\"text-align:left\">manufacturer</th><th style=\"text-align:left\">model</th><th style=\"text-align:left\">displ</th><th style=\"text-align:left\">year</th><th style=\"text-align:left\">cyl</th><th style=\"text-align:left\">trans</th><th style=\"text-align:left\">drv</th><th style=\"text-align:left\">cty</th><th style=\"text-align:left\">hwy</th><th style=\"text-align:left\">fl</th><th style=\"text-align:left\">class</th></tr><tr><td style=\"text-align:left\" title=\"1\">1</td><td style=\"text-align:left\" title=\"audi\">audi</td><td style=\"text-align:left\" title=\"a4\">a4</td><td style=\"text-align:left\" title=\"1.8\">1.8</td><td style=\"text-align:left\" title=\"1999\">1999</td><td style=\"text-align:left\" title=\"4\">4</td><td style=\"text-align:left\" title=\"auto(l5)\">auto(l5)</td><td style=\"text-align:left\" title=\"f\">f</td><td style=\"text-align:left\" title=\"18\">18</td><td style=\"text-align:left\" title=\"29\">29</td><td style=\"text-align:left\" title=\"p\">p</td><td style=\"text-align:left\" title=\"compact\">compact</td></tr><tr><td style=\"text-align:left\" title=\"2\">2</td><td style=\"text-align:left\" title=\"audi\">audi</td><td style=\"text-align:left\" title=\"a4\">a4</td><td style=\"text-align:left\" title=\"1.8\">1.8</td><td style=\"text-align:left\" title=\"1999\">1999</td><td style=\"text-align:left\" title=\"4\">4</td><td style=\"text-align:left\" title=\"manual(m5)\">manual(m5)</td><td style=\"text-align:left\" title=\"f\">f</td><td style=\"text-align:left\" title=\"21\">21</td><td style=\"text-align:left\" title=\"29\">29</td><td style=\"text-align:left\" title=\"p\">p</td><td style=\"text-align:left\" title=\"compact\">compact</td></tr><tr><td style=\"text-align:left\" title=\"3\">3</td><td style=\"text-align:left\" title=\"audi\">audi</td><td style=\"text-align:left\" title=\"a4\">a4</td><td style=\"text-align:left\" title=\"2.0\">2.0</td><td style=\"text-align:left\" title=\"2008\">2008</td><td style=\"text-align:left\" title=\"4\">4</td><td style=\"text-align:left\" title=\"manual(m6)\">manual(m6)</td><td style=\"text-align:left\" title=\"f\">f</td><td style=\"text-align:left\" title=\"20\">20</td><td style=\"text-align:left\" title=\"31\">31</td><td style=\"text-align:left\" title=\"p\">p</td><td style=\"text-align:left\" title=\"compact\">compact</td></tr></table><p>Shape: 3 x 12. \n",
       "</p></body></html>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "val mpg = DataFrame.readCSV(\"https://raw.githubusercontent.com/JetBrains/lets-plot-kotlin/master/docs/examples/data/mpg.csv\")\n",
    "mpg.head(3)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "central-heart",
   "metadata": {},
   "outputs": [],
   "source": [
    "val p = letsPlot(mpg.toMap()) { y = \"hwy\" } + theme(axisTitleX=\"blank\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "original-textbook",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "   <div id=\"WeGTNU\"></div>\n",
       "   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n",
       "       (function() {\n",
       "           var plotSpec={\n",
       "\"kind\":\"ggbunch\",\n",
       "\"items\":[{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"default\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,NaN,23.0,NaN,NaN,NaN,NaN,17.0,25.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,26.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,26.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,24.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,23.0,NaN,NaN,20.0],\n",
       "\"hwy\":[35.0,37.0,35.0,44.0,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,17.0,NaN,12.0,12.0,12.0,22.0,NaN,NaN,44.0,41.0,NaN],\n",
       "\"class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"2seater\",\"subcompact\",\"subcompact\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"alphabetically\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,NaN,23.0,NaN,NaN,NaN,NaN,17.0,25.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,26.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,26.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,24.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,23.0,NaN,NaN,20.0],\n",
       "\"hwy\":[35.0,37.0,35.0,44.0,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,17.0,NaN,12.0,12.0,12.0,22.0,NaN,NaN,44.0,41.0,NaN],\n",
       "\"@as_discrete@class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"2seater\",\"subcompact\",\"subcompact\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"by 'middle' ↑\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order_by\":\"..middle..\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,NaN,23.0,NaN,NaN,NaN,NaN,17.0,25.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,26.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,26.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,24.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,23.0,NaN,NaN,20.0],\n",
       "\"@as_discrete@class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"2seater\",\"subcompact\",\"subcompact\",\"subcompact\"],\n",
       "\"hwy\":[35.0,37.0,35.0,44.0,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,17.0,NaN,12.0,12.0,12.0,22.0,NaN,NaN,44.0,41.0,NaN]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"by 'middle' ↓\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order_by\":\"..middle..\",\n",
       "\"order\":-1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,NaN,23.0,NaN,NaN,NaN,NaN,17.0,25.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,26.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,26.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,24.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,23.0,NaN,NaN,20.0],\n",
       "\"@as_discrete@class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"2seater\",\"subcompact\",\"subcompact\",\"subcompact\"],\n",
       "\"hwy\":[35.0,37.0,35.0,44.0,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,17.0,NaN,12.0,12.0,12.0,22.0,NaN,NaN,44.0,41.0,NaN]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":600,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"by 'ymax' ↑\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order_by\":\"..ymax..\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,NaN,23.0,NaN,NaN,NaN,NaN,17.0,25.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,26.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,26.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,24.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,23.0,NaN,NaN,20.0],\n",
       "\"hwy\":[35.0,37.0,35.0,44.0,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,17.0,NaN,12.0,12.0,12.0,22.0,NaN,NaN,44.0,41.0,NaN],\n",
       "\"@as_discrete@class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"2seater\",\"subcompact\",\"subcompact\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":600,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"by 'ymax' ↓\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order_by\":\"..ymax..\",\n",
       "\"order\":-1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,NaN,23.0,NaN,NaN,NaN,NaN,17.0,25.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,26.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,26.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,24.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,23.0,NaN,NaN,20.0],\n",
       "\"hwy\":[35.0,37.0,35.0,44.0,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,17.0,NaN,12.0,12.0,12.0,22.0,NaN,NaN,44.0,41.0,NaN],\n",
       "\"@as_discrete@class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"2seater\",\"subcompact\",\"subcompact\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "}]\n",
       "};\n",
       "           var plotContainer = document.getElementById(\"WeGTNU\");\n",
       "           window.letsPlotCall(function() {{\n",
       "               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);\n",
       "           }});\n",
       "       })();    \n",
       "   </script>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "val p1 = p + ggtitle(\"default\") + geomBoxplot{ x = \"class\" }\n",
    "val p2 = p + ggtitle(\"alphabetically\") + geomBoxplot{ x = asDiscrete(\"class\", order = 1) }\n",
    "val p3 = p + ggtitle(\"by 'middle' ↑\") + geomBoxplot{ x = asDiscrete(\"class\", orderBy = \"..middle..\", order = 1) }\n",
    "val p4 = p + ggtitle(\"by 'middle' ↓\") + geomBoxplot{ x = asDiscrete(\"class\", orderBy = \"..middle..\", order = -1) }\n",
    "val p5 = p + ggtitle(\"by 'ymax' ↑\") + geomBoxplot{ x = asDiscrete(\"class\", orderBy = \"..ymax..\", order = 1) }\n",
    "val p6 = p + ggtitle(\"by 'ymax' ↓\") + geomBoxplot{ x = asDiscrete(\"class\", orderBy = \"..ymax..\", order = -1) }\n",
    "     \n",
    "val w = 470 \n",
    "val h = 300\n",
    "\n",
    "val bunch = GGBunch()\n",
    "bunch.addPlot(p1, 0, 0, w, h)\n",
    "bunch.addPlot(p2, w, 0, w, h)\n",
    "bunch.addPlot(p3, 0, h, w, h)\n",
    "bunch.addPlot(p4, w, h, w, h)\n",
    "bunch.addPlot(p5, 0, h*2, w, h)\n",
    "bunch.addPlot(p6, w, h*2, w, h)\n",
    "\n",
    "bunch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "stainless-browser",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "   <div id=\"qR8Z5a\"></div>\n",
       "   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n",
       "       (function() {\n",
       "           var plotSpec={\n",
       "\"kind\":\"ggbunch\",\n",
       "\"items\":[{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"x='class', color='class'\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"class\",\n",
       "\"color\":\"class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,25.0,NaN,23.0,NaN,NaN,NaN,NaN,17.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,26.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,26.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,24.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,23.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,NaN,NaN,20.0],\n",
       "\"hwy\":[35.0,37.0,35.0,44.0,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,NaN,17.0,NaN,12.0,12.0,12.0,22.0,NaN,44.0,41.0,NaN],\n",
       "\"class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"x=asDiscrete('class', order=1), color='class'\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\",\n",
       "\"color\":\"class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[25.0,NaN,NaN,NaN,NaN,27.0,27.0,NaN,23.0,NaN,NaN,NaN,NaN,17.0,NaN,NaN,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5],\n",
       "\"..upper..\":[26.0,NaN,NaN,NaN,NaN,29.0,29.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,NaN,NaN,30.5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0],\n",
       "\"..ymax..\":[26.0,NaN,NaN,NaN,NaN,33.0,32.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,NaN,NaN,36.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0],\n",
       "\"..lower..\":[24.0,NaN,NaN,NaN,NaN,26.0,26.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,NaN,NaN,24.5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0],\n",
       "\"..ymin..\":[23.0,NaN,NaN,NaN,NaN,23.0,23.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,NaN,NaN,20.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0],\n",
       "\"@as_discrete@class\":[\"2seater\",\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\"],\n",
       "\"hwy\":[NaN,35.0,37.0,35.0,44.0,NaN,NaN,17.0,NaN,12.0,12.0,12.0,22.0,NaN,44.0,41.0,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN],\n",
       "\"class\":[\"2seater\",\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"x=asDiscrete('class', order=1),\\ncolor=asDiscrete('class')\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\",\n",
       "\"color\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order\":1\n",
       "}\n",
       "},{\n",
       "\"aes\":\"color\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\"\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,25.0,NaN,23.0,NaN,NaN,NaN,NaN,17.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,26.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,26.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,24.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,23.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,NaN,NaN,20.0],\n",
       "\"@as_discrete@class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\"],\n",
       "\"hwy\":[35.0,37.0,35.0,44.0,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,NaN,17.0,NaN,12.0,12.0,12.0,22.0,NaN,44.0,41.0,NaN]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":600,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"x='class', color='drv'\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"class\",\n",
       "\"color\":\"drv\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,29.0,27.0,NaN,23.0,NaN,NaN,29.0,25.0,24.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,18.0,NaN,NaN,NaN,NaN,17.0,26.0,NaN,NaN,NaN,17.0,25.0,23.0],\n",
       "\"..upper..\":[NaN,NaN,30.0,29.0,NaN,24.0,NaN,NaN,32.5,27.0,24.5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,NaN,NaN,NaN,18.0,26.0,NaN,NaN,NaN,18.0,26.0,25.0],\n",
       "\"..ymax..\":[NaN,NaN,35.0,32.0,NaN,24.0,NaN,NaN,36.0,28.0,25.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,NaN,NaN,NaN,20.0,26.0,NaN,NaN,NaN,18.0,26.0,26.0],\n",
       "\"..lower..\":[NaN,NaN,26.5,26.0,NaN,22.0,NaN,NaN,27.5,25.0,23.5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,NaN,NaN,NaN,16.0,26.0,NaN,NaN,NaN,17.0,24.0,22.0],\n",
       "\"drv\":[\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"r\",\"r\",\"r\",\"r\",\"r\",\"r\"],\n",
       "\"..ymin..\":[NaN,NaN,23.0,25.0,NaN,21.0,NaN,NaN,24.0,25.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,NaN,NaN,NaN,15.0,26.0,NaN,NaN,NaN,16.0,23.0,20.0],\n",
       "\"hwy\":[37.0,44.0,NaN,NaN,17.0,NaN,44.0,41.0,NaN,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,12.0,12.0,12.0,22.0,NaN,NaN,20.0,15.0,20.0,NaN,NaN,NaN],\n",
       "\"class\":[\"compact\",\"compact\",\"compact\",\"midsize\",\"minivan\",\"minivan\",\"subcompact\",\"subcompact\",\"subcompact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":900,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"x=asDiscrete('class', order=1),\\ncolor=asDiscrete('drv', order=1)\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\",\n",
       "\"color\":\"@as_discrete@drv\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order\":1\n",
       "}\n",
       "},{\n",
       "\"aes\":\"color\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"drv\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[25.0,24.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,18.0,NaN,NaN,NaN,NaN,17.0,26.0,NaN,NaN,29.0,27.0,NaN,23.0,NaN,NaN,29.0,NaN,NaN,NaN,17.0,25.0,23.0],\n",
       "\"..upper..\":[27.0,24.5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,NaN,NaN,NaN,18.0,26.0,NaN,NaN,30.0,29.0,NaN,24.0,NaN,NaN,32.5,NaN,NaN,NaN,18.0,26.0,25.0],\n",
       "\"@as_discrete@drv\":[\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"r\",\"r\",\"r\",\"r\",\"r\",\"r\"],\n",
       "\"..ymax..\":[28.0,25.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,NaN,NaN,NaN,20.0,26.0,NaN,NaN,35.0,32.0,NaN,24.0,NaN,NaN,36.0,NaN,NaN,NaN,18.0,26.0,26.0],\n",
       "\"..lower..\":[25.0,23.5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,NaN,NaN,NaN,16.0,26.0,NaN,NaN,26.5,26.0,NaN,22.0,NaN,NaN,27.5,NaN,NaN,NaN,17.0,24.0,22.0],\n",
       "\"..ymin..\":[25.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,NaN,NaN,NaN,15.0,26.0,NaN,NaN,23.0,25.0,NaN,21.0,NaN,NaN,24.0,NaN,NaN,NaN,16.0,23.0,20.0],\n",
       "\"hwy\":[NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,12.0,12.0,12.0,22.0,NaN,NaN,37.0,44.0,NaN,NaN,17.0,NaN,44.0,41.0,NaN,20.0,15.0,20.0,NaN,NaN,NaN],\n",
       "\"@as_discrete@class\":[\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"minivan\",\"minivan\",\"subcompact\",\"subcompact\",\"subcompact\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":900,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"x=asDiscrete('class', orderBy='..middle..')\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\",\n",
       "\"color\":\"drv\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"boxplot\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order_by\":\"..middle..\"\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,29.0,27.0,NaN,23.0,NaN,NaN,29.0,25.0,24.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,18.0,NaN,NaN,NaN,NaN,17.0,26.0,NaN,NaN,NaN,17.0,25.0,23.0],\n",
       "\"..upper..\":[NaN,NaN,30.0,29.0,NaN,24.0,NaN,NaN,32.5,27.0,24.5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,NaN,NaN,NaN,18.0,26.0,NaN,NaN,NaN,18.0,26.0,25.0],\n",
       "\"..ymax..\":[NaN,NaN,35.0,32.0,NaN,24.0,NaN,NaN,36.0,28.0,25.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,NaN,NaN,NaN,20.0,26.0,NaN,NaN,NaN,18.0,26.0,26.0],\n",
       "\"..lower..\":[NaN,NaN,26.5,26.0,NaN,22.0,NaN,NaN,27.5,25.0,23.5,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,NaN,NaN,NaN,16.0,26.0,NaN,NaN,NaN,17.0,24.0,22.0],\n",
       "\"drv\":[\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"r\",\"r\",\"r\",\"r\",\"r\",\"r\"],\n",
       "\"..ymin..\":[NaN,NaN,23.0,25.0,NaN,21.0,NaN,NaN,24.0,25.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,NaN,NaN,NaN,15.0,26.0,NaN,NaN,NaN,16.0,23.0,20.0],\n",
       "\"@as_discrete@class\":[\"compact\",\"compact\",\"compact\",\"midsize\",\"minivan\",\"minivan\",\"subcompact\",\"subcompact\",\"subcompact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"subcompact\"],\n",
       "\"hwy\":[37.0,44.0,NaN,NaN,17.0,NaN,44.0,41.0,NaN,NaN,NaN,12.0,12.0,25.0,24.0,27.0,25.0,26.0,23.0,NaN,12.0,12.0,12.0,22.0,NaN,NaN,20.0,15.0,20.0,NaN,NaN,NaN]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "}]\n",
       "};\n",
       "           var plotContainer = document.getElementById(\"qR8Z5a\");\n",
       "           window.letsPlotCall(function() {{\n",
       "               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);\n",
       "           }});\n",
       "       })();    \n",
       "   </script>"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "val classOrdered = asDiscrete(\"class\", order=1)\n",
    "\n",
    "val p10 = p + ggtitle(\"x='class', color='class'\") +\n",
    "              geomBoxplot{ x = \"class\"; color = \"class\" }\n",
    "              \n",
    "val p11 = p + ggtitle(\"x=asDiscrete('class', order=1), color='class'\") +\n",
    "              geomBoxplot{ x = classOrdered; color = \"class\" }              \n",
    "              \n",
    "val p12 = p + ggtitle(\"x=asDiscrete('class', order=1),\\ncolor=asDiscrete('class')\") +\n",
    "              geomBoxplot{ x = classOrdered; color = asDiscrete(\"class\") }\n",
    "              \n",
    "val p13 = p + ggtitle(\"x='class', color='drv'\") +\n",
    "              geomBoxplot{ x = \"class\"; color = \"drv\" }\n",
    "              \n",
    "val p14 = p + ggtitle(\"x=asDiscrete('class', order=1),\\ncolor=asDiscrete('drv', order=1)\") +\n",
    "              geomBoxplot{ x = classOrdered; color = asDiscrete(\"drv\", order=1) }\n",
    "              \n",
    "val p15 = p + ggtitle(\"x=asDiscrete('class', orderBy='..middle..')\") +\n",
    "              geomBoxplot{ x = asDiscrete(\"class\", orderBy=\"..middle..\"); color = \"drv\" }\n",
    "  \n",
    "\n",
    "val bunch1 = GGBunch()\n",
    "bunch1.addPlot(p10, 0, 0, w, h)\n",
    "bunch1.addPlot(p11, 0, h, w, h)\n",
    "bunch1.addPlot(p12, w, h, w, h)\n",
    "bunch1.addPlot(p13, 0, h*2, w, h)\n",
    "bunch1.addPlot(p14, 0, h*3, w, h)\n",
    "bunch1.addPlot(p15, w, h*3, w, h)\n",
    "\n",
    "bunch1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "matched-cowboy",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "   <div id=\"fQbOGz\"></div>\n",
       "   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n",
       "       (function() {\n",
       "           var plotSpec={\n",
       "\"kind\":\"ggbunch\",\n",
       "\"items\":[{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"default\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[{\n",
       "\"aesthetic\":\"color\",\n",
       "\"scale_mapper_kind\":\"color_brewer\",\n",
       "\"palette\":\"Dark2\"\n",
       "}],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"class\",\n",
       "\"color\":\"class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"crossbar\",\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,25.0,NaN,23.0,NaN,NaN,NaN,NaN,17.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,26.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,26.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,24.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,23.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,NaN,NaN,20.0],\n",
       "\"class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"order by 'middle' ↑, also applies to 'color'\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[{\n",
       "\"aesthetic\":\"color\",\n",
       "\"scale_mapper_kind\":\"color_brewer\",\n",
       "\"palette\":\"Dark2\"\n",
       "}],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\",\n",
       "\"color\":\"class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"crossbar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order_by\":\"..middle..\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,17.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,NaN,23.0,25.0,NaN,NaN,26.0,NaN,NaN,NaN,NaN,27.0,27.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,18.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,NaN,24.0,26.0,NaN,NaN,30.5,NaN,NaN,NaN,NaN,29.0,29.0],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,20.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,NaN,24.0,26.0,NaN,NaN,36.0,NaN,NaN,NaN,NaN,33.0,32.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,16.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,NaN,22.0,24.0,NaN,NaN,24.5,NaN,NaN,NaN,NaN,26.0,26.0],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,15.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,NaN,21.0,23.0,NaN,NaN,20.0,NaN,NaN,NaN,NaN,23.0,23.0],\n",
       "\"@as_discrete@class\":[\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"minivan\",\"minivan\",\"2seater\",\"subcompact\",\"subcompact\",\"subcompact\",\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\"],\n",
       "\"class\":[\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"minivan\",\"minivan\",\"2seater\",\"subcompact\",\"subcompact\",\"subcompact\",\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'class' and 'orderBy' + 'class' and 'order':\\noptions are combined\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[{\n",
       "\"aesthetic\":\"color\",\n",
       "\"scale_mapper_kind\":\"color_brewer\",\n",
       "\"palette\":\"Dark2\"\n",
       "}],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\",\n",
       "\"color\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"boxplot\",\n",
       "\"position\":{\n",
       "\"name\":\"dodge\",\n",
       "\"width\":0.95,\n",
       "\"kind\":\"pos\"\n",
       "},\n",
       "\"geom\":\"crossbar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order_by\":\"..middle..\"\n",
       "}\n",
       "},{\n",
       "\"aes\":\"color\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..middle..\":[NaN,NaN,NaN,NaN,27.0,27.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.5,25.0,NaN,23.0,NaN,NaN,NaN,NaN,17.0,NaN,NaN,26.0],\n",
       "\"..upper..\":[NaN,NaN,NaN,NaN,29.0,29.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,19.0,26.0,NaN,24.0,NaN,NaN,NaN,NaN,18.0,NaN,NaN,30.5],\n",
       "\"..ymax..\":[NaN,NaN,NaN,NaN,33.0,32.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,22.0,26.0,NaN,24.0,NaN,NaN,NaN,NaN,20.0,NaN,NaN,36.0],\n",
       "\"..lower..\":[NaN,NaN,NaN,NaN,26.0,26.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,17.0,24.0,NaN,22.0,NaN,NaN,NaN,NaN,16.0,NaN,NaN,24.5],\n",
       "\"..ymin..\":[NaN,NaN,NaN,NaN,23.0,23.0,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,14.0,23.0,NaN,21.0,NaN,NaN,NaN,NaN,15.0,NaN,NaN,20.0],\n",
       "\"@as_discrete@class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"minivan\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "}]\n",
       "};\n",
       "           var plotContainer = document.getElementById(\"fQbOGz\");\n",
       "           window.letsPlotCall(function() {{\n",
       "               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);\n",
       "           }});\n",
       "       })();    \n",
       "   </script>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "val p21 = p +\n",
    "        geomCrossbar(stat = Stat.boxplot()) { x = \"class\"; color = \"class\"} +\n",
    "        scaleColorBrewer(palette = \"Dark2\") +\n",
    "        ggtitle(\"default\")\n",
    "        \n",
    "val p22 = p +\n",
    "        geomCrossbar(stat = Stat.boxplot()) { \n",
    "            x = asDiscrete(\"class\", orderBy = \"..middle..\", order = 1); \n",
    "            color = \"class\"} +\n",
    "        scaleColorBrewer(palette = \"Dark2\") +\n",
    "        ggtitle(\"order by 'middle' ↑, also applies to 'color'\")        \n",
    "val p23 = p +\n",
    "        geomCrossbar(stat = Stat.boxplot()) { \n",
    "            x = asDiscrete(\"class\", orderBy = \"..middle..\"); \n",
    "            color = asDiscrete(\"class\", order = 1)} +\n",
    "        scaleColorBrewer(palette = \"Dark2\") +\n",
    "        ggtitle(\"'class' and 'orderBy' + 'class' and 'order':\\noptions are combined\")      \n",
    "        \n",
    "val bunch2 = GGBunch()\n",
    "bunch2.addPlot(p21, 0, 0, w, h)\n",
    "bunch2.addPlot(p22, w, 0, w, h)\n",
    "bunch2.addPlot(p23, 0, h, w, h)\n",
    "bunch2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "conceptual-gender",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "   <div id=\"rZ9MAN\"></div>\n",
       "   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n",
       "       (function() {\n",
       "           var plotSpec={\n",
       "\"kind\":\"ggbunch\",\n",
       "\"items\":[{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"default\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"hwy\":[47.0,41.0,62.0,5.0,11.0,33.0,35.0],\n",
       "\"class\":[\"compact\",\"midsize\",\"suv\",\"2seater\",\"minivan\",\"pickup\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"alphabetically\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"hwy\":[47.0,41.0,62.0,5.0,11.0,33.0,35.0],\n",
       "\"@as_discrete@class\":[\"compact\",\"midsize\",\"suv\",\"2seater\",\"minivan\",\"pickup\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"by 'hwy' ↓\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order_by\":\"hwy\"\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"@as_discrete@class\":[\"compact\",\"midsize\",\"suv\",\"2seater\",\"minivan\",\"pickup\",\"subcompact\"],\n",
       "\"hwy\":[47.0,41.0,62.0,5.0,11.0,33.0,35.0]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"by 'hwy' ↑\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order_by\":\"hwy\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"hwy\":[47.0,41.0,62.0,5.0,11.0,33.0,35.0],\n",
       "\"@as_discrete@class\":[\"compact\",\"midsize\",\"suv\",\"2seater\",\"minivan\",\"pickup\",\"subcompact\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "}]\n",
       "};\n",
       "           var plotContainer = document.getElementById(\"rZ9MAN\");\n",
       "           window.letsPlotCall(function() {{\n",
       "               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);\n",
       "           }});\n",
       "       })();    \n",
       "   </script>"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "val p31 = p + ggtitle(\"default\") + geomBar { x = \"class\" }\n",
    "val p32 = p + ggtitle(\"alphabetically\") + geomBar { x = asDiscrete(\"class\", order = 1) }\n",
    "val p33 = p + ggtitle(\"by 'hwy' ↓\") + geomBar { x = asDiscrete(\"class\", orderBy = \"hwy\") }\n",
    "val p34 = p + ggtitle(\"by 'hwy' ↑\") + geomBar { x = asDiscrete(\"class\", orderBy = \"hwy\", order = 1) }\n",
    "\n",
    "val bunch3 = GGBunch()\n",
    "bunch3.addPlot(p31, 0, 0, w, h)\n",
    "bunch3.addPlot(p32, w, 0, w, h)\n",
    "bunch3.addPlot(p33, 0, h, w, h)\n",
    "bunch3.addPlot(p34, w, h, w, h)\n",
    "bunch3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "graduate-porter",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "   <div id=\"WTLpxA\"></div>\n",
       "   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n",
       "       (function() {\n",
       "           var plotSpec={\n",
       "\"kind\":\"ggbunch\",\n",
       "\"items\":[{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"default\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"manufacturer\",\n",
       "\"fill\":\"class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"hwy\":[15.0,2.0,4.0,12.0,14.0,3.0,5.0,7.0,7.0,5.0,7.0,7.0,9.0,7.0,9.0,8.0,4.0,3.0,4.0,4.0,6.0,8.0,5.0,11.0,19.0,7.0,7.0,9.0,9.0,7.0,4.0,6.0],\n",
       "\"class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\"],\n",
       "\"manufacturer\":[\"audi\",\"nissan\",\"subaru\",\"toyota\",\"volkswagen\",\"audi\",\"chevrolet\",\"hyundai\",\"nissan\",\"pontiac\",\"toyota\",\"volkswagen\",\"chevrolet\",\"dodge\",\"ford\",\"jeep\",\"land rover\",\"lincoln\",\"mercury\",\"nissan\",\"subaru\",\"toyota\",\"chevrolet\",\"dodge\",\"dodge\",\"ford\",\"toyota\",\"ford\",\"honda\",\"hyundai\",\"subaru\",\"volkswagen\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' alphabetically\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@manufacturer\",\n",
       "\"fill\":\"class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"manufacturer\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"hwy\":[15.0,2.0,4.0,12.0,14.0,3.0,5.0,7.0,7.0,5.0,7.0,7.0,9.0,7.0,9.0,8.0,4.0,3.0,4.0,4.0,6.0,8.0,5.0,11.0,19.0,7.0,7.0,9.0,9.0,7.0,4.0,6.0],\n",
       "\"class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\"],\n",
       "\"@as_discrete@manufacturer\":[\"audi\",\"nissan\",\"subaru\",\"toyota\",\"volkswagen\",\"audi\",\"chevrolet\",\"hyundai\",\"nissan\",\"pontiac\",\"toyota\",\"volkswagen\",\"chevrolet\",\"dodge\",\"ford\",\"jeep\",\"land rover\",\"lincoln\",\"mercury\",\"nissan\",\"subaru\",\"toyota\",\"chevrolet\",\"dodge\",\"dodge\",\"ford\",\"toyota\",\"ford\",\"honda\",\"hyundai\",\"subaru\",\"volkswagen\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' alphabetically + samplingPick(4)\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@manufacturer\",\n",
       "\"fill\":\"class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"sampling\":{\n",
       "\"n\":4.0,\n",
       "\"name\":\"pick\"\n",
       "},\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"manufacturer\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"hwy\":[15.0,3.0,5.0,9.0,7.0,9.0,5.0,11.0,19.0,7.0,9.0],\n",
       "\"class\":[\"compact\",\"midsize\",\"midsize\",\"suv\",\"suv\",\"suv\",\"2seater\",\"minivan\",\"pickup\",\"pickup\",\"subcompact\"],\n",
       "\"@as_discrete@manufacturer\":[\"audi\",\"audi\",\"chevrolet\",\"chevrolet\",\"dodge\",\"ford\",\"chevrolet\",\"dodge\",\"dodge\",\"ford\",\"ford\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "},\n",
       "\"computation_messages\":[\"sampling_pick(n=4) was applied to [bar/count stat] layer\"]\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":600,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'fill' alphabetically\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"manufacturer\",\n",
       "\"fill\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"fill\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"hwy\":[5.0,15.0,2.0,4.0,12.0,14.0,3.0,5.0,7.0,7.0,5.0,7.0,7.0,11.0,19.0,7.0,7.0,9.0,9.0,7.0,4.0,6.0,9.0,7.0,9.0,8.0,4.0,3.0,4.0,4.0,6.0,8.0],\n",
       "\"@as_discrete@class\":[\"2seater\",\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\"],\n",
       "\"manufacturer\":[\"chevrolet\",\"audi\",\"nissan\",\"subaru\",\"toyota\",\"volkswagen\",\"audi\",\"chevrolet\",\"hyundai\",\"nissan\",\"pontiac\",\"toyota\",\"volkswagen\",\"dodge\",\"dodge\",\"ford\",\"toyota\",\"ford\",\"honda\",\"hyundai\",\"subaru\",\"volkswagen\",\"chevrolet\",\"dodge\",\"ford\",\"jeep\",\"land rover\",\"lincoln\",\"mercury\",\"nissan\",\"subaru\",\"toyota\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":600,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' & 'fill' alphabetically\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@manufacturer\",\n",
       "\"fill\":\"@as_discrete@class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"manufacturer\",\n",
       "\"order\":1\n",
       "}\n",
       "},{\n",
       "\"aes\":\"fill\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"class\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"hwy\":[5.0,15.0,2.0,4.0,12.0,14.0,3.0,5.0,7.0,7.0,5.0,7.0,7.0,11.0,19.0,7.0,7.0,9.0,9.0,7.0,4.0,6.0,9.0,7.0,9.0,8.0,4.0,3.0,4.0,4.0,6.0,8.0],\n",
       "\"@as_discrete@class\":[\"2seater\",\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\"],\n",
       "\"@as_discrete@manufacturer\":[\"chevrolet\",\"audi\",\"nissan\",\"subaru\",\"toyota\",\"volkswagen\",\"audi\",\"chevrolet\",\"hyundai\",\"nissan\",\"pontiac\",\"toyota\",\"volkswagen\",\"dodge\",\"dodge\",\"ford\",\"toyota\",\"ford\",\"honda\",\"hyundai\",\"subaru\",\"volkswagen\",\"chevrolet\",\"dodge\",\"ford\",\"jeep\",\"land rover\",\"lincoln\",\"mercury\",\"nissan\",\"subaru\",\"toyota\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":900,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' by count ('sum' aggregation)\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@manufacturer\",\n",
       "\"fill\":\"class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"manufacturer\",\n",
       "\"order_by\":\"..count..\"\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..count..\":[15.0,2.0,4.0,12.0,14.0,3.0,5.0,7.0,7.0,5.0,7.0,7.0,9.0,7.0,9.0,8.0,4.0,3.0,4.0,4.0,6.0,8.0,5.0,11.0,19.0,7.0,7.0,9.0,9.0,7.0,4.0,6.0],\n",
       "\"hwy\":[15.0,2.0,4.0,12.0,14.0,3.0,5.0,7.0,7.0,5.0,7.0,7.0,9.0,7.0,9.0,8.0,4.0,3.0,4.0,4.0,6.0,8.0,5.0,11.0,19.0,7.0,7.0,9.0,9.0,7.0,4.0,6.0],\n",
       "\"class\":[\"compact\",\"compact\",\"compact\",\"compact\",\"compact\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"midsize\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"suv\",\"2seater\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\",\"subcompact\"],\n",
       "\"@as_discrete@manufacturer\":[\"audi\",\"nissan\",\"subaru\",\"toyota\",\"volkswagen\",\"audi\",\"chevrolet\",\"hyundai\",\"nissan\",\"pontiac\",\"toyota\",\"volkswagen\",\"chevrolet\",\"dodge\",\"ford\",\"jeep\",\"land rover\",\"lincoln\",\"mercury\",\"nissan\",\"subaru\",\"toyota\",\"chevrolet\",\"dodge\",\"dodge\",\"ford\",\"toyota\",\"ford\",\"honda\",\"hyundai\",\"subaru\",\"volkswagen\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":900,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' by count + samplingPick(4)\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"y\":\"hwy\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@manufacturer\",\n",
       "\"fill\":\"class\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"sampling\":{\n",
       "\"n\":4.0,\n",
       "\"name\":\"pick\"\n",
       "},\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"manufacturer\",\n",
       "\"order_by\":\"..count..\"\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"..count..\":[12.0,14.0,7.0,7.0,7.0,9.0,8.0,11.0,19.0,7.0,7.0,9.0,6.0],\n",
       "\"hwy\":[12.0,14.0,7.0,7.0,7.0,9.0,8.0,11.0,19.0,7.0,7.0,9.0,6.0],\n",
       "\"class\":[\"compact\",\"compact\",\"midsize\",\"midsize\",\"suv\",\"suv\",\"suv\",\"minivan\",\"pickup\",\"pickup\",\"pickup\",\"subcompact\",\"subcompact\"],\n",
       "\"@as_discrete@manufacturer\":[\"toyota\",\"volkswagen\",\"toyota\",\"volkswagen\",\"dodge\",\"ford\",\"toyota\",\"dodge\",\"dodge\",\"ford\",\"toyota\",\"ford\",\"volkswagen\"]\n",
       "}\n",
       "}],\n",
       "\"theme\":{\n",
       "\"axis_title_x\":\"blank\"\n",
       "},\n",
       "\"computation_messages\":[\"sampling_pick(n=4) was applied to [bar/count stat] layer\"]\n",
       "},\n",
       "\"height\":300\n",
       "}]\n",
       "};\n",
       "           var plotContainer = document.getElementById(\"WTLpxA\");\n",
       "           window.letsPlotCall(function() {{\n",
       "               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);\n",
       "           }});\n",
       "       })();    \n",
       "   </script>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "val p41 = p + ggtitle(\"default\") + geomBar { x = \"manufacturer\"; fill = \"class\" }\n",
    "val p42 = p + ggtitle(\"'x' alphabetically\") + geomBar { x = asDiscrete(\"manufacturer\", order = 1); fill = \"class\" }\n",
    "val p43 = p + ggtitle(\"'x' alphabetically + samplingPick(4)\") + \n",
    "              geomBar(sampling = samplingPick(4)) { \n",
    "                            x = asDiscrete(\"manufacturer\", order = 1); \n",
    "                            fill = \"class\" \n",
    "                          }\n",
    "val p44 = p + ggtitle(\"'fill' alphabetically\") + geomBar { x = \"manufacturer\"; fill = asDiscrete(\"class\", order=1) }\n",
    "val p45 = p + ggtitle(\"'x' & 'fill' alphabetically\") + \n",
    "              geomBar { x = asDiscrete(\"manufacturer\", order=1); fill = asDiscrete(\"class\", order=1) }\n",
    "val p46 = p + ggtitle(\"'x' by count ('sum' aggregation)\") + \n",
    "              geomBar { x = asDiscrete(\"manufacturer\", orderBy=\"..count..\"); fill = \"class\" }\n",
    "val p47 = p + ggtitle(\"'x' by count + samplingPick(4)\") + \n",
    "              geomBar(sampling = samplingPick(4)) { \n",
    "                            x = asDiscrete(\"manufacturer\", orderBy=\"..count..\"); \n",
    "                            fill = \"class\" \n",
    "                          }\n",
    "\n",
    "val bunch4 = GGBunch()\n",
    "bunch4.addPlot(p41, 0, 0, w, h)\n",
    "bunch4.addPlot(p42, 0, h, w, h)\n",
    "bunch4.addPlot(p43, w, h, w, h)\n",
    "bunch4.addPlot(p44, 0, h*2, w, h)\n",
    "bunch4.addPlot(p45, w, h*2, w, h)\n",
    "bunch4.addPlot(p46, 0, h*3, w, h)\n",
    "bunch4.addPlot(p47, w, h*3, w, h)\n",
    "bunch4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "french-agent",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "   <div id=\"ues4M6\"></div>\n",
       "   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n",
       "       (function() {\n",
       "           var plotSpec={\n",
       "\"kind\":\"ggbunch\",\n",
       "\"items\":[{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"Default\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"x\":\"fl\",\n",
       "\"fill\":\"drv\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"..count..\":[25.0,76.0,1.0,1.0,3.0,20.0,75.0,6.0,2.0,17.0,1.0,7.0],\n",
       "\"fl\":[\"p\",\"r\",\"e\",\"c\",\"d\",\"p\",\"r\",\"e\",\"d\",\"r\",\"e\",\"p\"],\n",
       "\"drv\":[\"f\",\"f\",\"f\",\"f\",\"f\",\"4\",\"4\",\"4\",\"4\",\"r\",\"r\",\"r\"]\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"With Dodge Position\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"x\":\"fl\",\n",
       "\"fill\":\"drv\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"dodge\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"fl\":[\"p\",\"r\",\"e\",\"c\",\"d\",\"p\",\"r\",\"e\",\"d\",\"r\",\"e\",\"p\"],\n",
       "\"..count..\":[25.0,76.0,1.0,1.0,3.0,20.0,75.0,6.0,2.0,17.0,1.0,7.0],\n",
       "\"drv\":[\"f\",\"f\",\"f\",\"f\",\"f\",\"4\",\"4\",\"4\",\"4\",\"r\",\"r\",\"r\"]\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' and 'fill' alphabetically\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@fl\",\n",
       "\"fill\":\"@as_discrete@drv\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"@as_discrete@drv\":[\"4\",\"4\",\"4\",\"4\",\"f\",\"f\",\"f\",\"f\",\"f\",\"r\",\"r\",\"r\"],\n",
       "\"@as_discrete@fl\":[\"p\",\"r\",\"e\",\"d\",\"p\",\"r\",\"e\",\"c\",\"d\",\"r\",\"e\",\"p\"],\n",
       "\"..count..\":[20.0,75.0,6.0,2.0,25.0,76.0,1.0,1.0,3.0,17.0,1.0,7.0]\n",
       "}\n",
       "}],\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"fl\",\n",
       "\"order\":1\n",
       "}\n",
       "},{\n",
       "\"aes\":\"fill\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"drv\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' and 'fill' alphabetically\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@fl\",\n",
       "\"fill\":\"@as_discrete@drv\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"dodge\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"@as_discrete@drv\":[\"4\",\"4\",\"4\",\"4\",\"f\",\"f\",\"f\",\"f\",\"f\",\"r\",\"r\",\"r\"],\n",
       "\"@as_discrete@fl\":[\"p\",\"r\",\"e\",\"d\",\"p\",\"r\",\"e\",\"c\",\"d\",\"r\",\"e\",\"p\"],\n",
       "\"..count..\":[20.0,75.0,6.0,2.0,25.0,76.0,1.0,1.0,3.0,17.0,1.0,7.0]\n",
       "}\n",
       "}],\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"fl\",\n",
       "\"order\":1\n",
       "}\n",
       "},{\n",
       "\"aes\":\"fill\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"drv\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":600,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' by 'count'\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@fl\",\n",
       "\"fill\":\"drv\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"@as_discrete@fl\":[\"p\",\"r\",\"e\",\"c\",\"d\",\"p\",\"r\",\"e\",\"d\",\"r\",\"e\",\"p\"],\n",
       "\"..count..\":[25.0,76.0,1.0,1.0,3.0,20.0,75.0,6.0,2.0,17.0,1.0,7.0],\n",
       "\"drv\":[\"f\",\"f\",\"f\",\"f\",\"f\",\"4\",\"4\",\"4\",\"4\",\"r\",\"r\",\"r\"]\n",
       "}\n",
       "}],\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"fl\",\n",
       "\"order_by\":\"..count..\"\n",
       "}\n",
       "}]\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":600,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' by 'count'\"\n",
       "},\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@fl\",\n",
       "\"fill\":\"drv\"\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"dodge\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"@as_discrete@fl\":[\"p\",\"r\",\"e\",\"c\",\"d\",\"p\",\"r\",\"e\",\"d\",\"r\",\"e\",\"p\"],\n",
       "\"..count..\":[25.0,76.0,1.0,1.0,3.0,20.0,75.0,6.0,2.0,17.0,1.0,7.0],\n",
       "\"drv\":[\"f\",\"f\",\"f\",\"f\",\"f\",\"4\",\"4\",\"4\",\"4\",\"r\",\"r\",\"r\"]\n",
       "}\n",
       "}],\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"fl\",\n",
       "\"order_by\":\"..count..\"\n",
       "}\n",
       "}]\n",
       "}\n",
       "},\n",
       "\"height\":300\n",
       "}]\n",
       "};\n",
       "           var plotContainer = document.getElementById(\"ues4M6\");\n",
       "           window.letsPlotCall(function() {{\n",
       "               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);\n",
       "           }});\n",
       "       })();    \n",
       "   </script>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "val pp = letsPlot(mpg.toMap()) { x = \"fl\"; fill = \"drv\" }\n",
    "val p51 = pp + geomBar() + ggtitle(\"Default\")\n",
    "val p52 = pp + geomBar(position=positionDodge()) + ggtitle(\"With Dodge Position\")\n",
    "\n",
    "val pOrder1 = ggplot(mpg.toMap()) { x = asDiscrete(\"fl\", order=1); fill = asDiscrete(\"drv\", order=1) }\n",
    "val title1 = ggtitle(\"'x' and 'fill' alphabetically\")\n",
    "\n",
    "val p53 = pOrder1 + geomBar() + title1\n",
    "val p54 = pOrder1 + geomBar(position=positionDodge()) + title1\n",
    "\n",
    "val pOrder2 = ggplot(mpg.toMap()) { x = asDiscrete(\"fl\", orderBy=\"..count..\"); fill = \"drv\" }\n",
    "val title2 = ggtitle(\"'x' by 'count'\")\n",
    "\n",
    "val p55 = pOrder2 + geomBar() + title2\n",
    "val p56 = pOrder2 + geomBar(position=positionDodge()) + title2\n",
    "\n",
    "\n",
    "val bunch5 = GGBunch()\n",
    "bunch5.addPlot(p51, 0, 0, w, h)\n",
    "bunch5.addPlot(p52, w, 0, w, h)\n",
    "bunch5.addPlot(p53, 0, h, w, h)\n",
    "bunch5.addPlot(p54, w, h, w, h)\n",
    "bunch5.addPlot(p55, 0, h*2, w, h)\n",
    "bunch5.addPlot(p56, w, h*2, w, h)\n",
    "bunch5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "fabulous-northwest",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<html><body><table><tr><th style=\"text-align:left\"></th><th style=\"text-align:left\">carat</th><th style=\"text-align:left\">cut</th><th style=\"text-align:left\">color</th><th style=\"text-align:left\">clarity</th><th style=\"text-align:left\">depth</th><th style=\"text-align:left\">table</th><th style=\"text-align:left\">price</th><th style=\"text-align:left\">x</th><th style=\"text-align:left\">y</th><th style=\"text-align:left\">z</th></tr><tr><td style=\"text-align:left\" title=\"1\">1</td><td style=\"text-align:left\" title=\"0.23\">0.23</td><td style=\"text-align:left\" title=\"Ideal\">Ideal</td><td style=\"text-align:left\" title=\"E\">E</td><td style=\"text-align:left\" title=\"SI2\">SI2</td><td style=\"text-align:left\" title=\"61.5\">61.5</td><td style=\"text-align:left\" title=\"55.0\">55.0</td><td style=\"text-align:left\" title=\"326\">326</td><td style=\"text-align:left\" title=\"3.95\">3.95</td><td style=\"text-align:left\" title=\"3.98\">3.98</td><td style=\"text-align:left\" title=\"2.43\">2.43</td></tr><tr><td style=\"text-align:left\" title=\"2\">2</td><td style=\"text-align:left\" title=\"0.21\">0.21</td><td style=\"text-align:left\" title=\"Premium\">Premium</td><td style=\"text-align:left\" title=\"E\">E</td><td style=\"text-align:left\" title=\"SI1\">SI1</td><td style=\"text-align:left\" title=\"59.8\">59.8</td><td style=\"text-align:left\" title=\"61.0\">61.0</td><td style=\"text-align:left\" title=\"326\">326</td><td style=\"text-align:left\" title=\"3.89\">3.89</td><td style=\"text-align:left\" title=\"3.84\">3.84</td><td style=\"text-align:left\" title=\"2.31\">2.31</td></tr><tr><td style=\"text-align:left\" title=\"3\">3</td><td style=\"text-align:left\" title=\"0.23\">0.23</td><td style=\"text-align:left\" title=\"Good\">Good</td><td style=\"text-align:left\" title=\"E\">E</td><td style=\"text-align:left\" title=\"VS1\">VS1</td><td style=\"text-align:left\" title=\"56.9\">56.9</td><td style=\"text-align:left\" title=\"65.0\">65.0</td><td style=\"text-align:left\" title=\"327\">327</td><td style=\"text-align:left\" title=\"4.05\">4.05</td><td style=\"text-align:left\" title=\"4.07\">4.07</td><td style=\"text-align:left\" title=\"2.31\">2.31</td></tr></table><p>Shape: 3 x 11. \n",
       "</p></body></html>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "// diamonds\n",
    "\n",
    "val diamonds = DataFrame.readCSV(\"https://vincentarelbundock.github.io/Rdatasets/csv/ggplot2/diamonds.csv\")\n",
    "diamonds.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "charming-match",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "   <div id=\"N85Wgr\"></div>\n",
       "   <script type=\"text/javascript\" data-lets-plot-script=\"plot\">\n",
       "       (function() {\n",
       "           var plotSpec={\n",
       "\"kind\":\"ggbunch\",\n",
       "\"items\":[{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"Default\"\n",
       "},\n",
       "\"mapping\":{\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"cut\",\n",
       "\"fill\":\"clarity\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"stack\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"cut\":[\"Ideal\",\"Good\",\"Premium\",\"Very Good\",\"Fair\",\"Premium\",\"Very Good\",\"Good\",\"Ideal\",\"Fair\",\"Good\",\"Very Good\",\"Ideal\",\"Premium\",\"Fair\",\"Premium\",\"Fair\",\"Very Good\",\"Good\",\"Ideal\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\",\"Premium\",\"Very Good\",\"Fair\",\"Ideal\",\"Good\",\"Ideal\",\"Premium\",\"Very Good\",\"Fair\",\"Good\"],\n",
       "\"clarity\":[\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"I1\",\"I1\",\"I1\",\"I1\",\"I1\",\"IF\",\"IF\",\"IF\",\"IF\",\"IF\"],\n",
       "\"..count..\":[2598.0,1081.0,2949.0,2100.0,466.0,3575.0,3240.0,1560.0,4282.0,408.0,648.0,1775.0,3589.0,1989.0,170.0,3357.0,261.0,2591.0,978.0,5071.0,1235.0,2606.0,870.0,286.0,69.0,789.0,2047.0,616.0,186.0,17.0,205.0,84.0,210.0,146.0,96.0,1212.0,230.0,268.0,9.0,71.0]\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":0,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"position='fill'\"\n",
       "},\n",
       "\"mapping\":{\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"cut\",\n",
       "\"fill\":\"clarity\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"fill\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"cut\":[\"Ideal\",\"Good\",\"Premium\",\"Very Good\",\"Fair\",\"Premium\",\"Very Good\",\"Good\",\"Ideal\",\"Fair\",\"Good\",\"Very Good\",\"Ideal\",\"Premium\",\"Fair\",\"Premium\",\"Fair\",\"Very Good\",\"Good\",\"Ideal\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\",\"Premium\",\"Very Good\",\"Fair\",\"Ideal\",\"Good\",\"Ideal\",\"Premium\",\"Very Good\",\"Fair\",\"Good\"],\n",
       "\"clarity\":[\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"I1\",\"I1\",\"I1\",\"I1\",\"I1\",\"IF\",\"IF\",\"IF\",\"IF\",\"IF\"],\n",
       "\"..count..\":[2598.0,1081.0,2949.0,2100.0,466.0,3575.0,3240.0,1560.0,4282.0,408.0,648.0,1775.0,3589.0,1989.0,170.0,3357.0,261.0,2591.0,978.0,5071.0,1235.0,2606.0,870.0,286.0,69.0,789.0,2047.0,616.0,186.0,17.0,205.0,84.0,210.0,146.0,96.0,1212.0,230.0,268.0,9.0,71.0]\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' and 'fill' alphabetically\"\n",
       "},\n",
       "\"mapping\":{\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@cut\",\n",
       "\"fill\":\"@as_discrete@clarity\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"fill\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"cut\",\n",
       "\"order\":1\n",
       "}\n",
       "},{\n",
       "\"aes\":\"fill\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"clarity\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"@as_discrete@cut\":[\"Premium\",\"Very Good\",\"Fair\",\"Ideal\",\"Good\",\"Ideal\",\"Premium\",\"Very Good\",\"Fair\",\"Good\",\"Premium\",\"Very Good\",\"Good\",\"Ideal\",\"Fair\",\"Ideal\",\"Good\",\"Premium\",\"Very Good\",\"Fair\",\"Good\",\"Very Good\",\"Ideal\",\"Premium\",\"Fair\",\"Premium\",\"Fair\",\"Very Good\",\"Good\",\"Ideal\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\"],\n",
       "\"..count..\":[205.0,84.0,210.0,146.0,96.0,1212.0,230.0,268.0,9.0,71.0,3575.0,3240.0,1560.0,4282.0,408.0,2598.0,1081.0,2949.0,2100.0,466.0,648.0,1775.0,3589.0,1989.0,170.0,3357.0,261.0,2591.0,978.0,5071.0,789.0,2047.0,616.0,186.0,17.0,1235.0,2606.0,870.0,286.0,69.0],\n",
       "\"@as_discrete@clarity\":[\"I1\",\"I1\",\"I1\",\"I1\",\"I1\",\"IF\",\"IF\",\"IF\",\"IF\",\"IF\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\"]\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":300,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' order by 'count'\"\n",
       "},\n",
       "\"mapping\":{\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@cut\",\n",
       "\"fill\":\"@as_discrete@clarity\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"fill\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"cut\",\n",
       "\"order_by\":\"..count..\"\n",
       "}\n",
       "},{\n",
       "\"aes\":\"fill\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"clarity\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"@as_discrete@cut\":[\"Premium\",\"Very Good\",\"Fair\",\"Ideal\",\"Good\",\"Ideal\",\"Premium\",\"Very Good\",\"Fair\",\"Good\",\"Premium\",\"Very Good\",\"Good\",\"Ideal\",\"Fair\",\"Ideal\",\"Good\",\"Premium\",\"Very Good\",\"Fair\",\"Good\",\"Very Good\",\"Ideal\",\"Premium\",\"Fair\",\"Premium\",\"Fair\",\"Very Good\",\"Good\",\"Ideal\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\"],\n",
       "\"..count..\":[205.0,84.0,210.0,146.0,96.0,1212.0,230.0,268.0,9.0,71.0,3575.0,3240.0,1560.0,4282.0,408.0,2598.0,1081.0,2949.0,2100.0,466.0,648.0,1775.0,3589.0,1989.0,170.0,3357.0,261.0,2591.0,978.0,5071.0,789.0,2047.0,616.0,186.0,17.0,1235.0,2606.0,870.0,286.0,69.0],\n",
       "\"@as_discrete@clarity\":[\"I1\",\"I1\",\"I1\",\"I1\",\"I1\",\"IF\",\"IF\",\"IF\",\"IF\",\"IF\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\"]\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":0,\n",
       "\"width\":470,\n",
       "\"y\":600,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"position='dodge'\"\n",
       "},\n",
       "\"mapping\":{\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"cut\",\n",
       "\"fill\":\"clarity\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"dodge\",\n",
       "\"geom\":\"bar\",\n",
       "\"data\":{\n",
       "\"cut\":[\"Ideal\",\"Good\",\"Premium\",\"Very Good\",\"Fair\",\"Premium\",\"Very Good\",\"Good\",\"Ideal\",\"Fair\",\"Good\",\"Very Good\",\"Ideal\",\"Premium\",\"Fair\",\"Premium\",\"Fair\",\"Very Good\",\"Good\",\"Ideal\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\",\"Premium\",\"Very Good\",\"Fair\",\"Ideal\",\"Good\",\"Ideal\",\"Premium\",\"Very Good\",\"Fair\",\"Good\"],\n",
       "\"clarity\":[\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"I1\",\"I1\",\"I1\",\"I1\",\"I1\",\"IF\",\"IF\",\"IF\",\"IF\",\"IF\"],\n",
       "\"..count..\":[2598.0,1081.0,2949.0,2100.0,466.0,3575.0,3240.0,1560.0,4282.0,408.0,648.0,1775.0,3589.0,1989.0,170.0,3357.0,261.0,2591.0,978.0,5071.0,1235.0,2606.0,870.0,286.0,69.0,789.0,2047.0,616.0,186.0,17.0,205.0,84.0,210.0,146.0,96.0,1212.0,230.0,268.0,9.0,71.0]\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"height\":300\n",
       "},{\n",
       "\"x\":470,\n",
       "\"width\":470,\n",
       "\"y\":600,\n",
       "\"feature_spec\":{\n",
       "\"ggtitle\":{\n",
       "\"text\":\"'x' order by 'count' and 'fill' - alphabetically\"\n",
       "},\n",
       "\"mapping\":{\n",
       "},\n",
       "\"data\":{\n",
       "},\n",
       "\"kind\":\"plot\",\n",
       "\"scales\":[],\n",
       "\"layers\":[{\n",
       "\"mapping\":{\n",
       "\"x\":\"@as_discrete@cut\",\n",
       "\"fill\":\"@as_discrete@clarity\"\n",
       "},\n",
       "\"stat\":\"count\",\n",
       "\"position\":\"dodge\",\n",
       "\"geom\":\"bar\",\n",
       "\"data_meta\":{\n",
       "\"mapping_annotations\":[{\n",
       "\"aes\":\"x\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"cut\",\n",
       "\"order_by\":\"..count..\"\n",
       "}\n",
       "},{\n",
       "\"aes\":\"fill\",\n",
       "\"annotation\":\"as_discrete\",\n",
       "\"parameters\":{\n",
       "\"label\":\"clarity\",\n",
       "\"order\":1\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"data\":{\n",
       "\"@as_discrete@cut\":[\"Premium\",\"Very Good\",\"Fair\",\"Ideal\",\"Good\",\"Ideal\",\"Premium\",\"Very Good\",\"Fair\",\"Good\",\"Premium\",\"Very Good\",\"Good\",\"Ideal\",\"Fair\",\"Ideal\",\"Good\",\"Premium\",\"Very Good\",\"Fair\",\"Good\",\"Very Good\",\"Ideal\",\"Premium\",\"Fair\",\"Premium\",\"Fair\",\"Very Good\",\"Good\",\"Ideal\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\",\"Very Good\",\"Ideal\",\"Premium\",\"Good\",\"Fair\"],\n",
       "\"..count..\":[205.0,84.0,210.0,146.0,96.0,1212.0,230.0,268.0,9.0,71.0,3575.0,3240.0,1560.0,4282.0,408.0,2598.0,1081.0,2949.0,2100.0,466.0,648.0,1775.0,3589.0,1989.0,170.0,3357.0,261.0,2591.0,978.0,5071.0,789.0,2047.0,616.0,186.0,17.0,1235.0,2606.0,870.0,286.0,69.0],\n",
       "\"@as_discrete@clarity\":[\"I1\",\"I1\",\"I1\",\"I1\",\"I1\",\"IF\",\"IF\",\"IF\",\"IF\",\"IF\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"SI1\",\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"SI2\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS1\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VS2\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS1\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\",\"VVS2\"]\n",
       "}\n",
       "}]\n",
       "},\n",
       "\"height\":300\n",
       "}]\n",
       "};\n",
       "           var plotContainer = document.getElementById(\"N85Wgr\");\n",
       "           window.letsPlotCall(function() {{\n",
       "               LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer);\n",
       "           }});\n",
       "       })();    \n",
       "   </script>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "val pd = letsPlot(diamonds.toMap())\n",
    "\n",
    "val p61 = pd + geomBar { x = \"cut\"; fill = \"clarity\" } + ggtitle(\"Default\")\n",
    "\n",
    "val p62 = pd + geomBar(position=positionFill) { x = \"cut\"; fill = \"clarity\" } + ggtitle(\"position='fill'\")\n",
    "val p63 = pd + ggtitle(\"'x' and 'fill' alphabetically\") +\n",
    "          geomBar(position=positionFill) { x = asDiscrete(\"cut\", order=1); \n",
    "                                       fill = asDiscrete(\"clarity\", order=1) }\n",
    "val p64 = pd + ggtitle(\"'x' order by 'count'\") +\n",
    "          geomBar(position=positionFill) { x = asDiscrete(\"cut\", orderBy=\"..count..\"); \n",
    "                                       fill = asDiscrete(\"clarity\", order=1) }\n",
    "\n",
    "val p65 = pd + geomBar(position=positionDodge()) { x = \"cut\"; fill = \"clarity\" } + ggtitle(\"position='dodge'\")\n",
    "val p66 = pd + ggtitle(\"'x' order by 'count' and 'fill' - alphabetically\") +\n",
    "          geomBar(position=positionDodge()) { x = asDiscrete(\"cut\", orderBy=\"..count..\"); \n",
    "                                        fill = asDiscrete(\"clarity\", order=1) }\n",
    "\n",
    "\n",
    "val bunch6 = GGBunch()\n",
    "bunch6.addPlot(p61, 0, 0, w, h)\n",
    "bunch6.addPlot(p62, w, 0, w, h)\n",
    "bunch6.addPlot(p63, 0, h, w, h)\n",
    "bunch6.addPlot(p64, w, h, w, h)\n",
    "bunch6.addPlot(p65, 0, h*2, w, h)\n",
    "bunch6.addPlot(p66, w, h*2, w, h)\n",
    "bunch6"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Kotlin",
   "language": "kotlin",
   "name": "kotlin"
  },
  "language_info": {
   "codemirror_mode": "text/x-kotlin",
   "file_extension": ".kt",
   "mimetype": "text/x-kotlin",
   "name": "kotlin",
   "nbconvert_exporter": "",
   "pygments_lexer": "kotlin",
   "version": "1.7.20-dev-1299"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
